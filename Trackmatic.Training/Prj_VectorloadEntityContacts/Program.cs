using System;
using System.Collections.Generic;

namespace Prj_VectorloadEntityContacts
{
    class Program
    {
        static void Main(string[] args)
        {
            var VectorID = new List<string>() { "212", "213", "300", "216", "217", "266", "202", "221", "218", "219", "214", "220", "215", "222", "223", "349", "297", "204" };
            var VectorHeadings = new List<string>() { "First Name", "Last Name", "Tel No", "Cell No", "Email", "Adn", "Adn Email", "Adn Sms", "Entity Name", "Entity Refernce" };
            var reference = new List<string>(){"177373","148341","108298","161614","159940","174108","155592","170730","171597","172373","122815","172327","108273","174768","172464","179341","130087","108165","157782","170546","105763","162099","178694","179225","177530",
"172328",
"121030",
"148596",
"162848",
"152860",
"170344",
"181433",
"108324",
"177250",
"156485",
"157890",
"179522",
"129098",
"177525",
"176333",
"108301",
"156206",
"121398",
"105751",
"140477",
"152803",
"159973",
"121767",
"142553",
"139652",
"158571",
"139506",
"176422",
"158544",
"179212",
"178498",
"175830",
"138660",
"176150",
"134132",
"108320",
"109073",
"170583",
"148962",
"155979",
"111537",
"151055",
"155885",
"170373",
"132204",
"159754",
"177561",
"170638",
"148440",
"177506",
"181434",
"122776",
"148818",
"180270",
"177526",
"181431",
"179063",
"179356",
"174832",
"172329",
"147295",
"171168",
"158527",
"174564",
"142486",
"178123",
"155465",
"108258",
"172465",
"108309",
"142610",
"177374",
"145241",
"177527",
"160788",
"144002",
"168828",
"161004",
"163298",
"172383",
"171683",
"111999",
"146637",
"130974",
"134952",
"155356",
"177101",
"121383",
"180295",
"128373",
"172466",
"176930",
"175831",
"136259",
"143078",
"142876",
"142073",
"181432",
"103181",
"181430",
"178358",
"134618",
"147787",
"146687",
"170682",
"165068",
"165133",
"162099",
"165560",
"142232",
"165559",
"171169",
"1655598",
"171031",
"159755",
"144205",
"162916",
"181442",
"144198",
"111080",
"150702",
"128843",
"112738",
"178218",
"161094",
"144015",
"174750",
"171638",
"170126",
"178992",
"173962",
"134128",
"155575",
"156131",
"148288",
"165635",
"163420",
"157449",
"176156",
"175751",
"176152",
"176149",
"176151",
"172372",
"143965",
"108318",
"153235",
"176944",
"142210",
"108332",
"178998",
"172467",
"156202",
"164846",
"158522",
"177529",
"177399",
"121291",
"172330",
"160305",
"113398",
"163216",
"172473",
"173739",
"165489",
"140823",
"155293",
"108084",
"132259",
"174881",
"179151",
"155829",
"144281",
"178360",
"119789",
"178064",
"160741",
"179939",
"171750",
"171171",
"176180",
"127611",
"161096",
"108314",
"158528",
"174844",
"139941",
"158200",
"107695",
"175538",
"165513",
"172326",
"155296",
"155626",
"172474",
"135839",
"108279",
"159182",
"107023",
"103183",
"174241",
"136324",
"155234",
"164822",
"170344",
"150459",
"181435",
"136323",
"142694",
"135283",
"108334",
"155541",
"143935",
"108265",
"135877",
"128134",
"151308",
"156531",
"179322",
"125422",
"159760",
"181437",
"143427",
"143179",
"179694",
"181436",
"181438",
"162913",
"172325",
"132589",
"138656",
"173979",
"108342",
"158503",
"159429",
"171172",
"173740",
"138714",
"179690",
"104947",
"172001",
"162989",
"178497",
"144212",
"156208",
"152876",
"175829",
"179289",
"148401",
"134815",
"146963",
"146595",
"124717",
"105865",
"174771",
"175688",
"156501",
"156501",
"151023",
"155680",
"174238",
"151288",
"130331"};
            var fileName = "Vector20190211";
            var fileDirectory = $"{Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)}/Temp";
            var Entities = new List<EntityAndContactModel>();

            foreach (var ID in VectorID)
            {
                var entityLookUp = new EntityLookup(ID, reference);
                var LoadedEntity = entityLookUp.PullData();
                Entities.AddRange(LoadedEntity);
            }

            var writeFile = new WriteToExcel(Entities, fileName, VectorHeadings);
            writeFile.Write(fileDirectory);
        }

    }
}
